{% extends "rpm_layout.html" %}
{% block body %}
  <div class="differences">
    {% for id_comp, comp in comparison.items() %}
      <h3>Comparison</h3>
      <table>
        <tr>
          <td>Comparison</td>
          <td><a href="{{ url_for('rpmdiff.show_groups', id=comp['id_group']) }}">{{ id_comp }}</a></td>
        </tr>
        <tr>
          <td>Package 1</td>
          <td><a href="{{ url_for('rpmdiff.show_packages', id=comp['pkg1']['id']) }}">{{ comp['pkg1']['filename'] }}</a></td>
        </tr>
        <tr>
          <td>Package 2</td>
          <td><a href="{{ url_for('rpmdiff.show_packages', id=comp['pkg2']['id']) }}">{{ comp['pkg2']['filename'] }}</a></td>
        </tr>
        <tr>
          <td>State</td>
          <td>{{ comp['state'] }}</td>
        </tr>
      </table>

      <h3>Tags</h3>
      <table>
        <tr>
          <th>Id</th>
          <th>Type</th>
          <th>Diff</th>
          <th>State</th>
          <th>Waive</th>
        </tr>
        {% for diff in comp['differences'] if diff['category'] == CATEGORY_STRINGS[CATEGORY_TAGS] %}
          <tr>
            <td>{{ diff['id'] }}</td>
            <td class={{ 'diff_type_' + diff['diff_type'] }}>{{ diff['diff_type'] }}</td>
            <td>{{ diff['diff'] }}</td>
            <td {% if diff['waived'] %} class="state_waived" {% else %} class={{ 'state_' + diff['state'] }} {% endif %}>{{ diff['state'] }}</td>
            <td>
              <form action="{{ url_for('rpmdiff.waive') }}" method="post">
                <input type="hidden" name="id_diff" value="{{ diff['id'] }}" />
                <input type="hidden" name="id_comp" value="{{ id_comp }}" />
                <input type="submit" {% if diff['waived'] %} value="Unwaive" {% else %} value="Waive" {% endif %}/>
              </form>
            </td>
          </tr>
        {% endfor %}
      </table>

      <h3>PRCO</h3>
      <table>
        <tr>
          <th>Id</th>
          <th>Type</th>
          <th>Diff</th>
          <th>State</th>
          <th>Waive</th>
        </tr>
        {% for diff in comp['differences'] if diff['category'] == CATEGORY_STRINGS[CATEGORY_PRCO] %}
          <tr>
            <td>{{ diff['id'] }}</td>
            <td class={{ 'diff_type_' + diff['diff_type'] }}>{{ diff['diff_type'] }}</td>
            <td>{{ diff['diff'] }}</td>
            <td {% if diff['waived'] %} class="state_waived" {% else %} class={{ 'state_' + diff['state'] }} {% endif %}>{{ diff['state'] }}</td>
            <td>
              <form action="{{ url_for('rpmdiff.waive') }}" method="post">
                <input type="hidden" name="id_diff" value="{{ diff['id'] }}" />
                <input type="hidden" name="id_comp" value="{{ id_comp }}" />
                <input type="submit" {% if diff['waived'] %} value="Unwaive" {% else %} value="Waive" {% endif %}/>
              </form>
            </td>
          </tr>
        {% endfor %}
      </table>

      <h3>Files</h3>
      <table>
        <tr>
          <th>Id</th>
          <th>Type</th>
          <th>Diff</th>
          <th>Info</th>
          <th>State</th>
          <th>Waive</th>
        </tr>
        {% for diff in comp['differences'] if diff['category'] == CATEGORY_STRINGS[CATEGORY_FILES] %}
          <tr>
            <td>{{ diff['id'] }}</td>
            <td class={{ 'diff_type_' + diff['diff_type'] }}>{{ diff['diff_type'] }}</td>
            <td>{{ diff['diff'] }}</td>
            <td>{% if diff['diff_info'] %}{{ diff['diff_info'] }}{% endif %}</td>
            <td {% if diff['waived'] %} class="state_waived" {% else %} class={{ 'state_' + diff['state'] }} {% endif %}>{{ diff['state'] }}</td>
            <td>
              <form action="{{ url_for('rpmdiff.waive') }}" method="post">
                <input type="hidden" name="id_diff" value="{{ diff['id'] }}" />
                <input type="hidden" name="id_comp" value="{{ id_comp }}" />
                <input type="submit" {% if diff['waived'] %} value="Unwaive" {% else %} value="Waive" {% endif %}/>
              </form>
            </td>
          </tr>
        {% endfor %}
      </table>
    {% endfor %}
  </div>
{% endblock %}
